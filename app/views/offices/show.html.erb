<div class="min-h-screen bg-gray-50">
  <%= render "shared/public_navbar" %>

  <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
    <div class="mb-4">
      <%= link_to "← Back to Offices", offices_path, class: "text-sm text-indigo-600 hover:text-indigo-900" %>
    </div>

    <!-- Header -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
      <h1 class="text-3xl font-bold text-gray-900">
        <%= @office.title %>
        <% if @office.seat.present? %>
          <span class="text-gray-500 font-normal">(<%= @office.seat %>)</span>
        <% end %>
      </h1>
      
      <div class="mt-3 flex flex-wrap gap-3">
        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium 
          <%= case @office.level
              when 'federal' then 'bg-purple-100 text-purple-800'
              when 'state' then 'bg-blue-100 text-blue-800'
              when 'local' then 'bg-green-100 text-green-800'
              end %>">
          <%= @office.level.titleize %>
        </span>
        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 text-gray-800 capitalize">
          <%= @office.branch %>
        </span>
        <% if @office.state.present? %>
          <%= link_to state_path(@office.state), class: "inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800 hover:bg-indigo-200" do %>
            <%= @office.state %>
          <% end %>
        <% end %>
      </div>

      <% if @office.body_name.present? || @office.office_category.present? %>
        <div class="mt-4 text-sm text-gray-600">
          <% if @office.body_name.present? %>
            <span class="font-medium">Body:</span> 
            <%= link_to @office.body_name, body_path(@office.body_name), class: "text-indigo-600 hover:text-indigo-900" %>
          <% end %>
          <% if @office.office_category.present? %>
            <span class="ml-4 font-medium">Category:</span> <%= @office.office_category %>
          <% end %>
        </div>
      <% end %>

      <% if @office.district.present? %>
        <div class="mt-4">
          <span class="text-sm text-gray-600">District:</span>
          <%= link_to @office.district.full_name, district_path(@office.district), class: "text-sm text-indigo-600 hover:text-indigo-900" %>
        </div>
      <% end %>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <div class="lg:col-span-2 space-y-6">
        <!-- Current Holder -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200">
          <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-lg font-semibold text-gray-900">Current Officeholder</h2>
          </div>
          <div class="p-6">
            <% if @current_holder %>
              <div class="flex items-center gap-4">
                <% if @current_holder.person.photo_url.present? %>
                  <img src="<%= @current_holder.person.photo_url %>" alt="" class="w-16 h-16 rounded-full object-cover">
                <% else %>
                  <div class="w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center">
                    <span class="text-gray-500 font-medium text-xl"><%= @current_holder.person.first_name.first %><%= @current_holder.person.last_name.first %></span>
                  </div>
                <% end %>
                <div>
                  <%= link_to @current_holder.person.full_name, person_path(@current_holder.person), class: "text-lg font-medium text-indigo-600 hover:text-indigo-900" %>
                  <% if @current_holder.person.primary_party %>
                    <div class="text-sm text-gray-500"><%= @current_holder.person.primary_party.name %></div>
                  <% end %>
                  <div class="mt-1 text-sm text-gray-500">
                    Since <%= @current_holder.start_date.strftime('%B %d, %Y') %>
                    <% if @current_holder.term_end_date.present? %>
                      · Term ends <%= @current_holder.term_end_date.strftime('%B %d, %Y') %>
                    <% end %>
                  </div>
                </div>
              </div>
            <% else %>
              <p class="text-gray-500">This office is currently vacant.</p>
            <% end %>
          </div>
        </div>

        <!-- Past Holders -->
        <% if @past_holders.any? %>
          <div class="bg-white rounded-lg shadow-sm border border-gray-200">
            <div class="px-6 py-4 border-b border-gray-200">
              <h2 class="text-lg font-semibold text-gray-900">Past Officeholders</h2>
            </div>
            <div class="divide-y divide-gray-200">
              <% @past_holders.each do |officeholder| %>
                <div class="px-6 py-4 flex justify-between items-center">
                  <div>
                    <%= link_to officeholder.person.full_name, person_path(officeholder.person), class: "text-sm font-medium text-gray-900 hover:text-indigo-600" %>
                    <% if officeholder.person.primary_party %>
                      <span class="ml-2 text-sm text-gray-500">(<%= officeholder.person.primary_party.abbreviation %>)</span>
                    <% end %>
                  </div>
                  <div class="text-sm text-gray-500">
                    <%= officeholder.start_date.strftime('%b %Y') %> – <%= officeholder.end_date&.strftime('%b %Y') %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>

      <!-- Sidebar -->
      <div class="space-y-6">
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h3 class="text-lg font-semibold text-gray-900 mb-4">Office Details</h3>
          <dl class="space-y-3 text-sm">
            <div class="flex justify-between">
              <dt class="text-gray-500">Level</dt>
              <dd class="font-medium text-gray-900 capitalize"><%= @office.level %></dd>
            </div>
            <div class="flex justify-between">
              <dt class="text-gray-500">Branch</dt>
              <dd class="font-medium text-gray-900 capitalize"><%= @office.branch %></dd>
            </div>
            <% if @office.role.present? %>
              <div class="flex justify-between">
                <dt class="text-gray-500">Role</dt>
                <dd class="font-medium text-gray-900"><%= @office.role %></dd>
              </div>
            <% end %>
            <% if @office.state.present? %>
              <div class="flex justify-between">
                <dt class="text-gray-500">State</dt>
                <dd class="font-medium text-gray-900"><%= @office.state %></dd>
              </div>
            <% end %>
            <% if @office.county.present? %>
              <div class="flex justify-between">
                <dt class="text-gray-500">County</dt>
                <dd class="font-medium text-gray-900"><%= @office.county %></dd>
              </div>
            <% end %>
            <div class="flex justify-between">
              <dt class="text-gray-500">Total Holders</dt>
              <dd class="font-medium text-gray-900"><%= @office.officeholders.count %></dd>
            </div>
          </dl>
        </div>
      </div>
    </div>
  </main>
</div>
