<!DOCTYPE html>
<html>
  <head>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type' />
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        line-height: 1.6;
        color: #374151;
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
      }
      .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px 20px;
        border-radius: 8px 8px 0 0;
        text-align: center;
      }
      .header h1 {
        margin: 0;
        font-size: 24px;
        font-weight: 600;
      }
      .content {
        background: white;
        padding: 30px;
        border: 1px solid #e5e7eb;
        border-top: none;
      }
      .greeting {
        font-size: 18px;
        margin-bottom: 20px;
      }
      .intro {
        margin-bottom: 25px;
        color: #6b7280;
      }
      .assignment-list {
        margin: 20px 0;
      }
      .assignment-item {
        background: #f9fafb;
        border-left: 4px solid #667eea;
        padding: 15px;
        margin-bottom: 12px;
        border-radius: 4px;
      }
      .person-name {
        font-weight: 600;
        font-size: 16px;
        color: #111827;
        margin-bottom: 5px;
      }
      .assignment-meta {
        font-size: 14px;
        color: #6b7280;
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
      }
      .meta-item {
        display: flex;
        align-items: center;
      }
      .badge {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 500;
      }
      .badge-collection {
        background: #dbeafe;
        color: #1e40af;
      }
      .badge-validation {
        background: #e9d5ff;
        color: #6b21a8;
      }
      .badge-pending {
        background: #fef3c7;
        color: #92400e;
      }
      .badge-progress {
        background: #bfdbfe;
        color: #1e3a8a;
      }
      .button {
        display: inline-block;
        background: #667eea;
        color: white;
        padding: 12px 24px;
        text-decoration: none;
        border-radius: 6px;
        font-weight: 500;
        margin: 25px 0 15px 0;
      }
      .button:hover {
        background: #5568d3;
      }
      .footer {
        text-align: center;
        padding: 20px;
        color: #9ca3af;
        font-size: 14px;
        background: #f9fafb;
        border-radius: 0 0 8px 8px;
        border: 1px solid #e5e7eb;
        border-top: none;
      }
      .encouragement {
        background: #ecfdf5;
        border-left: 4px solid #10b981;
        padding: 15px;
        margin: 20px 0;
        border-radius: 4px;
        color: #065f46;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>ðŸ“‹ Assignment Reminder</h1>
    </div>

    <div class="content">
      <div class="greeting">
        Hi <%= @user.name || @user.email.split('@').first.titleize %>,
      </div>

      <div class="intro">
        This is a friendly reminder that you have <strong><%= @incomplete_assignments.count %></strong>
        <%= 'assignment'.pluralize(@incomplete_assignments.count) %> waiting to be completed in your CandiData queue.
      </div>

      <% if @incomplete_assignments.any? %>
        <div class="assignment-list">
          <% @incomplete_assignments.each do |assignment| %>
            <div class="assignment-item">
              <div class="person-name">
                <%= assignment.person.full_name %>
              </div>
              <div class="assignment-meta">
                <div class="meta-item">
                  <span class="badge <%= assignment.task_type == 'data_collection' ? 'badge-collection' : 'badge-validation' %>">
                    <%= assignment.task_type == 'data_collection' ? 'Data Collection' : 'Data Validation' %>
                  </span>
                </div>
                <div class="meta-item">
                  <span class="badge <%= assignment.status == 'pending' ? 'badge-pending' : 'badge-progress' %>">
                    <%= assignment.status.humanize %>
                  </span>
                </div>
                <div class="meta-item">
                  Assigned <%= time_ago_in_words(assignment.created_at) %> ago
                </div>
              </div>
            </div>
          <% end %>
        </div>

        <div class="encouragement">
          ðŸ’ª Your contributions help build a comprehensive database of candidate information. Thank you for your hard work!
        </div>

        <center>
          <a href="<%= researcher_assignments_url %>" class="button">
            View My Assignments
          </a>
        </center>
      <% end %>

      <p style="margin-top: 25px; color: #6b7280;">
        Questions or need help? Don't hesitate to reach out to your administrator.
      </p>
    </div>

    <div class="footer">
      <p style="margin: 0;">
        CandiData - Political Candidate Information Database
      </p>
      <p style="margin: 5px 0 0 0; font-size: 12px;">
        This is an automated reminder. Please do not reply to this email.
      </p>
    </div>
  </body>
</html>
