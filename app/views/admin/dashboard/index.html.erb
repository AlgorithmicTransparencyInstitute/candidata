<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
  <h1 class="text-3xl font-bold text-gray-900 mb-8">Admin Dashboard</h1>

  <!-- Assignment Workflow Stats -->
  <div class="mb-8">
    <h2 class="text-lg font-semibold text-gray-700 mb-4">Assignment Workflow</h2>
    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
      <div class="bg-white rounded-lg shadow p-4">
        <div class="text-2xl font-bold text-gray-900"><%= @assignment_stats[:total] %></div>
        <div class="text-sm text-gray-500">Total Assignments</div>
      </div>
      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
        <div class="text-2xl font-bold text-yellow-700"><%= @assignment_stats[:pending] %></div>
        <div class="text-sm text-yellow-600">Pending</div>
      </div>
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <div class="text-2xl font-bold text-blue-700"><%= @assignment_stats[:in_progress] %></div>
        <div class="text-sm text-blue-600">In Progress</div>
      </div>
      <div class="bg-green-50 border border-green-200 rounded-lg p-4">
        <div class="text-2xl font-bold text-green-700"><%= @assignment_stats[:completed] %></div>
        <div class="text-sm text-green-600">Completed</div>
      </div>
      <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
        <div class="text-2xl font-bold text-purple-700"><%= @assignment_stats[:collection_pending] %></div>
        <div class="text-sm text-purple-600">Collection Queue</div>
      </div>
      <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
        <div class="text-2xl font-bold text-indigo-700"><%= @assignment_stats[:validation_pending] %></div>
        <div class="text-sm text-indigo-600">Validation Queue</div>
      </div>
    </div>
  </div>

  <!-- Social Media Account Progress -->
  <div class="mb-8">
    <h2 class="text-lg font-semibold text-gray-700 mb-4">Social Media Accounts</h2>
    <div class="bg-white rounded-lg shadow p-6">
      <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-4">
        <div class="text-center">
          <div class="text-2xl font-bold text-gray-900"><%= @research_stats[:accounts_total] %></div>
          <div class="text-sm text-gray-500">Total Campaign</div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-gray-500"><%= @research_stats[:accounts_pending] %></div>
          <div class="text-sm text-gray-500">Pending</div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-blue-600"><%= @research_stats[:accounts_entered] %></div>
          <div class="text-sm text-gray-500">Entered</div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-green-600"><%= @research_stats[:accounts_verified] %></div>
          <div class="text-sm text-gray-500">Verified</div>
        </div>
        <div class="text-center">
          <div class="text-2xl font-bold text-red-600"><%= @research_stats[:accounts_rejected] %></div>
          <div class="text-sm text-gray-500">Rejected</div>
        </div>
      </div>
      <% if @research_stats[:accounts_total] > 0 %>
        <div class="w-full bg-gray-200 rounded-full h-3">
          <% verified_pct = (@research_stats[:accounts_verified].to_f / @research_stats[:accounts_total] * 100).round %>
          <% entered_pct = (@research_stats[:accounts_entered].to_f / @research_stats[:accounts_total] * 100).round %>
          <div class="flex h-3 rounded-full overflow-hidden">
            <div class="bg-green-500" style="width: <%= verified_pct %>%"></div>
            <div class="bg-blue-500" style="width: <%= entered_pct %>%"></div>
          </div>
        </div>
        <div class="flex justify-between text-xs text-gray-500 mt-1">
          <span>Progress: <%= verified_pct + entered_pct %>%</span>
          <span class="flex gap-4">
            <span class="flex items-center gap-1"><span class="w-2 h-2 bg-green-500 rounded-full"></span> Verified</span>
            <span class="flex items-center gap-1"><span class="w-2 h-2 bg-blue-500 rounded-full"></span> Entered</span>
          </span>
        </div>
      <% end %>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
    <!-- Recent Assignments -->
    <div class="bg-white rounded-lg shadow">
      <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
        <h2 class="text-lg font-semibold text-gray-900">Recent Assignments</h2>
        <%= link_to "View All", admin_assignments_path, class: "text-sm text-blue-600 hover:text-blue-800" %>
      </div>
      <div class="divide-y divide-gray-200">
        <% if @recent_assignments.any? %>
          <% @recent_assignments.each do |assignment| %>
            <div class="px-6 py-3 flex justify-between items-center">
              <div>
                <div class="font-medium text-gray-900"><%= assignment.person.full_name %></div>
                <div class="text-sm text-gray-500">
                  <%= assignment.task_type.humanize %> Â· <%= assignment.user&.name || 'Unassigned' %>
                </div>
              </div>
              <span class="px-2 py-1 text-xs rounded-full 
                <%= case assignment.status
                    when 'pending' then 'bg-yellow-100 text-yellow-800'
                    when 'in_progress' then 'bg-blue-100 text-blue-800'
                    when 'completed' then 'bg-green-100 text-green-800'
                    else 'bg-gray-100 text-gray-800'
                    end %>">
                <%= assignment.status.humanize %>
              </span>
            </div>
          <% end %>
        <% else %>
          <div class="px-6 py-8 text-center text-gray-500">No assignments yet</div>
        <% end %>
      </div>
    </div>

    <!-- Team -->
    <div class="bg-white rounded-lg shadow">
      <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
        <h2 class="text-lg font-semibold text-gray-900">Team</h2>
        <%= link_to "Manage Users", admin_users_path, class: "text-sm text-blue-600 hover:text-blue-800" %>
      </div>
      <div class="divide-y divide-gray-200">
        <% if @users.any? %>
          <% @users.each do |user| %>
            <div class="px-6 py-3 flex justify-between items-center">
              <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center">
                  <span class="text-gray-600 text-sm font-medium"><%= user.name&.first&.upcase || 'U' %></span>
                </div>
                <div>
                  <div class="font-medium text-gray-900"><%= user.name || user.email %></div>
                  <div class="text-sm text-gray-500"><%= user.role.titleize %></div>
                </div>
              </div>
              <div class="text-sm text-gray-500">
                <%= user.assignments.active.count %> active
              </div>
            </div>
          <% end %>
        <% else %>
          <div class="px-6 py-8 text-center text-gray-500">No users yet</div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Data Counts -->
  <div class="mb-8">
    <h2 class="text-lg font-semibold text-gray-700 mb-4">Database Overview</h2>
    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4">
      <% @data_counts.each do |key, count| %>
        <div class="bg-white rounded-lg shadow p-4 text-center">
          <div class="text-xl font-bold text-gray-900"><%= number_with_delimiter(count) %></div>
          <div class="text-xs text-gray-500"><%= key.to_s.titleize %></div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- People Needing Assignment -->
  <% if @unassigned_people.any? %>
    <div class="bg-white rounded-lg shadow">
      <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
        <h2 class="text-lg font-semibold text-gray-900">People Without Assignments</h2>
        <%= link_to "View All People", admin_people_path, class: "text-sm text-blue-600 hover:text-blue-800" %>
      </div>
      <div class="p-6">
        <div class="flex flex-wrap gap-2">
          <% @unassigned_people.each do |person| %>
            <%= link_to person.full_name, admin_person_path(person), class: "px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded text-sm text-gray-700" %>
          <% end %>
          <% unassigned_count = Person.left_joins(:assignments).where(assignments: { id: nil }).count %>
          <% if unassigned_count > 10 %>
            <span class="px-3 py-1 text-sm text-gray-500">+ <%= unassigned_count - 10 %> more</span>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>
